<script>
  //Avoid 3.4-1.6 = 1.79999999999
  function javascriptRound(num)
  {
    return Math.round(num*100000000)/100000000;
  }


  //Store machine's stored items, balance and total funds
  class VendingMachine
  {
    constructor(stock) {
      this.stock = stock;

      //Store current balance
      this.balance = 0;
      //Store money from sold items
      this.fund = 0;
    }

    //Add money to thet balance
    Insert(amount)
    {
      this.balance+=amount;
    }

    //Try to sell an item
    Choose(code)
    {
      //Existing item verificatiom
      if(this.stock[code] !== undefined)
      {
        //Enough quantity verification
        if(this.stock[code].qty > 0)
        {
          //Enough balance for price verification
          if(this.balance >= this.stock[code].item.price)
          {
            this.stock[code].qty -= 1;

            //Reduce balance and increase fund with item price
            this.balance = javascriptRound(this.balance - this.stock[code].item.price);
            this.fund = javascriptRound(this.fund + this.stock[code].item.price);

            return "Vending "+this.stock[code].item.name;
          }
          else
          {
            return "Not enough money!";
          }
        }
        else
        {
          return "Item "+this.stock[code].item.name+": Out of stock!";
        }
      }
      else
      {
        return "Invalid selection!";
      }
    }

    //Return current balance
    GetChange()
    {
      return this.balance;
    }

    //Return total price of sold items
    GetBalance()
    {
      return this.fund;
    }
  }

  //Store an item's name and price
  class Item
  {
    constructor(name, price) {
      this.name = name;
      this.price = price;
    }
  }


  //Test machine
  newStock = [];
  newStock["A01"] = {"item": new Item("Smarties", 1.6), "qty": 10};
  newStock["A02"] = {"item": new Item("Carampar", 0.6), "qty": 5};
  newStock["A03"] = {"item": new Item("Avril", 2.1), "qty": 2};
  newStock["A04"] = {"item": new Item("KokoKola", 2.95), "qty": 1};

  machine1 = new VendingMachine(newStock);


  //Tests cases
  switch(-1)
  {
    case 0:
    machine1.Insert(3.40);
    console.log(machine1.Choose("A01"));
    console.log(machine1.GetChange());
    break;

    case 1:
    machine1.Insert(2.10);
    console.log(machine1.Choose("A03"));
    console.log(machine1.GetChange());
    console.log(machine1.GetBalance());
    break;

    case 2:
    console.log(machine1.Choose("A01"));
    break;

    case 3:
    machine1.Insert(1.00);
    console.log(machine1.Choose("A01"));
    console.log(machine1.GetChange());
    console.log(machine1.Choose("A02"));
    console.log(machine1.GetChange());
    break;

    case 4:
    machine1.Insert(1.00);
    console.log(machine1.Choose("A05"));
    break;

    case 5:
    machine1.Insert(6.00);
    console.log(machine1.Choose("A04"));
    console.log(machine1.Choose("A04"));
    console.log(machine1.GetChange());
    break;

    case 6:
    machine1.Insert(6.00);
    console.log(machine1.Choose("A04"));
    machine1.Insert(6.00);
    console.log(machine1.Choose("A04"));
    console.log(machine1.Choose("A01"));
    console.log(machine1.Choose("A02"));
    console.log(machine1.Choose("A02"));
    console.log(machine1.GetChange());
    console.log(machine1.GetBalance());
    break;
  }

</script>
